---
title: "Third Obama-Romney Presidential Debate"
subtitle: "Claimbuster Data, EDA"
output: pdf_document
---

```{r}
library(rvest)
library(dplyr)
library(tidyr)
library(tidyverse)
library(knitr)
```


```{r}
all_sentences = read_csv("data/all_sentences.csv")
crowdsourced = read_csv("data/crowdsourced.csv")
groundtruth = read_csv("data/groundtruth.csv")
```

```{r}
rom_ob_all = all_sentences %>% 
  filter(File_id == "2012-10-22.txt")

rom_ob_crowd = crowdsourced %>% 
  filter(File_id == "2012-10-22.txt")

rom_ob_truth = crowdsourced %>% 
  filter(File_id == "2012-10-22.txt")
```

```{r}
rom_ob_entire <- rom_ob_all %>%
  filter(Speaker == "Mitt Romney" |
         Speaker == "Barack Obama")
```


```{r}
full_join(rom_ob_crowd, rom_ob_truth, Sentence_id = Sentence_id)
#essentially, these datasets are identical
write.csv(rom_ob_truth, 'rom_ob.csv', row.names=FALSE) 
```


**README Info from Claimbuster Datasets**

The ClaimBuster dataset consists of six files, the three used are the following:
groundtruth.csv, (22,501 sentences)
crowdsourced.csv, (1032 sentences)
all_sentences.csv, (32,072 sentences)

Both groundtruth.csv and crowdsourced.csv files contain the following attributes.
- Sentence_id: A unique numerical identifier to identify sentences in the dataset.
- Text: A sentence spoken by a debate participant. 
- Speaker: Name of the person who verbalized the Text.
- Speaker_title: Speakerâ€™s job at the time of the debate.
- Speaker_party: Political affiliation of the Speaker.
- File_id: Debate transcript name.
- Length: Number of words in the Text.  
- Line_number: A numerical identifier to to indicate the order of the Text in the debate transcript.
- Sentiment: Sentiment score of the Text. The score ranges from -1 (most negative sentiment) to 1 (most positive sentiment). 
- Verdict: Assigned class label (1 when the sentence is CFS,0 when the sentence is UFS, and -1 when sentence is NFS).

all_sentences.csv file contains all presidential debate sentences. It has all the features shown above except for ``Verdict''. It also includes the following attribute:
- Speaker_role: It depicts the role of the Speaker in the debate as a participant.

**FACT CHECKED DATA SET**
```{r}
ob_rom_factcheck <- read.csv("data/obrom_checkeddata.csv")

ob_rom_factcheck <- ob_rom_factcheck %>%
  mutate(Checked = Checked.)
```


```{r}
ob_rom_factcheck %>%
  filter(Checked == 1) %>%
  group_by(Speaker) %>%
  summarize(count = n()) %>%
  kable()
```
Total checked statements: 105

```{r}
ob_rom_factcheck %>%
  count(Checked, Speaker) %>%
  pivot_wider(id_cols = c(Checked, Speaker),
              names_from = Speaker, 
              values_from = n, 
              values_fill = 0) %>%
  kable()
```
13% of Obama's statements were checked, compared to 12% of Romney's
.
```{r}
ob_rom_factcheck <- ob_rom_factcheck %>%
  mutate(Checkability = 
        case_when(Verdict == "-1" ~ "Not Factual Statement",
                  Verdict == "0" ~ "Uncheckworthy Factual Statement",
                  Verdict == "1" ~ "Checkworthy Factual Statement"))

ob_rom_factcheck %>%
  count(Checkability, Speaker) %>%
  pivot_wider(id_cols = c(Checkability, Speaker),
              names_from = Speaker, 
              values_from = n, 
              values_fill = 0) %>%
  kable()

ob_rom_factcheck %>%
  filter(Checked == 1) %>%
  count(Checkability, Speaker) %>%
  pivot_wider(id_cols = c(Checkability, Speaker),
              names_from = Speaker, 
              values_from = n, 
              values_fill = 0) %>%
  kable()
```
```{r}
CNN <- ob_rom_factcheck %>%
  filter(CNN == "1") %>%
  group_by(Speaker) %>%
  summarize(CNN_check = n())

Reuters <- ob_rom_factcheck %>%
  filter(Reuters == "1") %>%
  group_by(Speaker) %>%
  summarize(Reuters_check = n())

APNews <- ob_rom_factcheck %>%
  filter(AP.News == "1") %>%
  group_by(Speaker) %>%
  summarize(AP_check = n())

NYT <- ob_rom_factcheck %>%
  filter(NYT == "1") %>%
  group_by(Speaker) %>%
  summarize(NYT_check = n())

Atl <- ob_rom_factcheck %>%
  filter(Atlantic == "1") %>%
  group_by(Speaker) %>%
  summarize(Atl_check = n())

PF <- ob_rom_factcheck %>%
  filter(Politifact == "1") %>%
  group_by(Speaker) %>%
  summarize(PF_check = n())

WP <- ob_rom_factcheck %>%
  filter(WashPost == "1") %>%
  group_by(Speaker) %>%
  summarize(WP_check = n())

FC <- ob_rom_factcheck %>%
  filter(Fact.Check == "1") %>%
  group_by(Speaker) %>%
  summarize(FC_check = n())

checkers = left_join(CNN, 
                     left_join(Reuters, 
                               left_join(APNews, 
                                         left_join(NYT, 
                                                   left_join(Atl, 
                                                             left_join(PF, left_join(WP, FC, by = "Speaker")))))))

checkers %>%
  kable()
```
1/8 fact checkers checked both speakers equally. (PolitiFact)
3/8 fact checkers checked Obama more than Romney. (Reuters, the Atlantic, the NYT)
4/8 fact checkers checked Romney more than Obama. (CNN, AP News, the Washington Post, Fact Check)

